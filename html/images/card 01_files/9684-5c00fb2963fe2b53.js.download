try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3c4df034-e718-4a89-aec3-1eb29de4e4e8",e._sentryDebugIdIdentifier="sentry-dbid-3c4df034-e718-4a89-aec3-1eb29de4e4e8")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9684],{76637:function(e,t,n){var r=n(57437),o=n(6528),a=n(12381),i=n(8227),u=n(40279),c=n(93448),s=n(33896),l=n(83337),d=n(33671),f=n(84522),m=n(21770),p=n(16593),x=n(40875),g=n(33954),y=n(32489),h=n(2265),b=n(29501),v=n(14438);t.Z=function(e){let{promoCodeData:t,setPromoCodeData:n,titleStyle:C,inputStyle:j,buttonStyle:N,couponBadgeStyle:w,couponTextStyle:_,discountTextStyle:I,couponContainerStyle:F,setIsPromoApplying:A}=e,[S,q]=(0,h.useState)(!1),{isAuthLoading:P,isAuthenticated:Z}=(0,s.a)(),k=(0,l.C)(e=>e.cart),E=(0,l.C)(e=>(0,d.FD)(e.cart)),z=(0,l.C)(e=>(0,d.hg)(e.cart)),{register:D,handleSubmit:T,formState:{errors:L},reset:O,setError:J,clearErrors:M}=(0,b.cI)(),{mutate:Q,isPending:G}=(0,m.D)({mutationFn:f.gs,onSuccess:e=>{if(e){let{promo_applied:t,promo_applied_message:r}=e.data;t?(n(e.data),q(!1),O()):t||(r?v.A.error(r):v.A.error("Promo code not available in your destination."))}},onError:e=>{n(null),v.A.error(e.message)},onMutate:()=>A(!0),onSettled:()=>A(!1)}),{mutate:R,isPending:B}=(0,m.D)({mutationFn:f.CA,onSuccess:e=>{if(e){let{promo_applied:t,promo_applied_message:r}=e.data;t?(n(e.data),q(!1),O()):t||(r?v.A.error(r):v.A.error("Promo code not available in your destination."))}},onError:e=>{v.A.error(e.message)},onMutate:()=>A(!0),onSettled:()=>A(!1)}),{isError:H,error:K}=(0,p.a)({queryKey:["guest-promo-code"],queryFn:()=>(0,f.CA)({cartItems:k,promoCode:null}),enabled:!Z&&!P});(0,h.useEffect)(()=>{t&&k.length>0&&(!P&&Z?Q({cartItems:k,promoCode:t.promo_code}):R({cartItems:k,promoCode:t.promo_code}))},[E,z,Z]);let U=G||B;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.zF,{className:(0,c.cn)("CollapsibleContent group mb-2",F),open:S,onOpenChange:q,children:[(0,r.jsxs)(i.wy,{className:"flex w-full items-center justify-between transition-all hover:text-primary",children:[(0,r.jsx)("p",{className:(0,c.cn)("font-montserrat text-lg font-semibold",C),children:"Got a discount code?"}),(0,r.jsx)(x.Z,{size:20,className:"transition-all group-data-[state=open]:rotate-180"})]}),(0,r.jsxs)(i.Fw,{className:"pt-2",children:[(0,r.jsxs)("form",{className:"flex items-center gap-2",onSubmit:T(function(e){if(t){J("coupon",{message:"A coupon code is already applied."});return}!P&&Z?Q({cartItems:k,promoCode:e.coupon}):H?v.A.error(K.message):R({cartItems:k,promoCode:e.coupon})}),children:[(0,r.jsx)(u.I,{placeholder:"Coupon Code",className:(0,c.cn)(j),disabled:U,type:"text",...D("coupon",{required:"Please enter a coupon code.",maxLength:{value:20,message:"Invalid coupon code."},validate:e=>!e.includes(" ")||"Coupon code cannot contain spaces."})}),(0,r.jsx)(a.z,{type:"submit",className:(0,c.cn)(N),disabled:U,children:U?(0,r.jsx)(o.Z,{}):"Apply"})]}),(null==L?void 0:L.coupon)&&(0,r.jsx)("span",{className:"text-xs text-destructive",children:L.coupon.message})]})]}),t&&(0,r.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,r.jsxs)("p",{className:(0,c.cn)("flex items-center gap-2 font-montserrat text-lg font-medium",_),children:[(0,r.jsx)(g.Z,{size:20}),"Coupon",(0,r.jsx)("span",{className:(0,c.cn)("rounded-md bg-primary-accent px-3 py-1 text-sm",w),children:t.promo_code}),(0,r.jsx)("button",{className:"text-muted-foreground hover:text-foreground",onClick:()=>{n(null),M()},children:(0,r.jsx)(y.Z,{size:16})})]}),(0,r.jsxs)("span",{className:(0,c.cn)("flex items-center justify-center rounded-[6px] bg-primary/15 px-[12px] py-[4px] text-base font-medium text-primary",I),children:[t.discount,"% Off"]})]})]})}},6528:function(e,t,n){var r=n(57437),o=n(51817);t.Z=function(){return(0,r.jsx)(o.Z,{className:"animate-spin"})}},93383:function(e,t,n){var r=n(57437),o=n(93448),a=n(27648);t.Z=function(e){let{children:t,className:n,...i}=e;return(0,r.jsx)(a.default,{className:(0,o.cn)("group flex items-center gap-4 text-foreground-light transition-all hover:text-primary hover:underline hover:underline-offset-4",n),...i,children:t})}},8227:function(e,t,n){n.d(t,{Fw:function(){return i},wy:function(){return a},zF:function(){return o}});var r=n(962);let o=r.fC,a=r.wy,i=r.Fw},33896:function(e,t,n){n.d(t,{a:function(){return l}});var r=n(57437),o=n(29827),a=n(64131),i=n(2265),u=n(67541),c=n(62974);let s=(0,i.createContext)({user:null,setUser:()=>{},isAuthenticated:!1,setIsAuthenticated:()=>{},logout:()=>{},isAuthLoading:!0,login:()=>{}});function l(){return(0,i.useContext)(s)}t.default=function(e){let{children:t}=e,[n,l]=(0,i.useState)(null),[d,f]=(0,i.useState)(!1),[m,p]=(0,i.useState)(!0),{setPromoCodeData:x}=(0,u.T)(),g=(0,o.NL)();async function y(){try{let e=a.Z.get("token"),t=await fetch("".concat(c.F,"/user"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json",...c.J}});if(!t.ok)throw Error(await t.text());let n=await t.json();if(!n.id)return h();l(n)}catch(e){h()}}function h(){f(!1),l(null),a.Z.remove("token"),g.clear(),x(null)}return(0,i.useEffect)(function(){let e=a.Z.get("token");p(!0),e?(f(!0),y()):h(),p(!1)},[]),(0,r.jsx)(s.Provider,{value:{user:n,setUser:l,isAuthenticated:d,setIsAuthenticated:f,isAuthLoading:m,logout:h,login:function(e){l(e.user),f(!0),a.Z.set("token",e.access_token,{expires:365})}},children:t})}},67541:function(e,t,n){n.d(t,{PromoCodeProvider:function(){return i},T:function(){return u}});var r=n(57437),o=n(2265);let a=(0,o.createContext)(void 0),i=e=>{let{children:t}=e,[n,i]=(0,o.useState)(null);return(0,r.jsx)(a.Provider,{value:{promoCodeData:n,setPromoCodeData:i},children:t})},u=()=>{let e=(0,o.useContext)(a);if(!e)throw Error("usePromoCode must be used within a PromoCodeProvider");return e}},83337:function(e,t,n){n.d(t,{C:function(){return a},T:function(){return o}});var r=n(68575);let o=r.I0,a=r.v9},33671:function(e,t,n){n.d(t,{C$:function(){return y},FD:function(){return m},G0:function(){return d},LL:function(){return l},Qd:function(){return c},a3:function(){return s},hg:function(){return p},jX:function(){return i},oP:function(){return x},wz:function(){return u}});var r=n(1455);let o=function(){{let e=localStorage.getItem("cartItems");return e?JSON.parse(e):[]}}(),a=(0,r.oM)({name:"cart",initialState:o,reducers:{addItem(e,t){if(f(e)){let{id:n,name:r,price:o,data_quantity:a,data_unit:i,package_validity:u,package_validity_unit:c,image_url:s,quantity:l,unlimited:d,provider:f,can_renew:m,package_type:p}=t.payload,x=e.find(e=>e.cart_id===n);if(x){x.quantity=x.quantity+l,x.total_price=Number((o*x.quantity).toFixed(2)),g(e);return}let y={id:n,name:r,price:o,data_quantity:a,data_unit:i,package_validity:u,package_validity_unit:c,image_url:s,quantity:l,cart_id:n,provider:f,unlimited:d,total_price:Number((o*l).toFixed(2)),recurring:0,can_renew:m,package_type:p};e.push(y),g(e)}},deleteItem(e,t){let n=e.findIndex(e=>e.cart_id===t.payload);-1!==n&&(e.splice(n,1),g(e))},increaseQuantity(e,t){if(f(e)){let n=e.find(e=>e.cart_id===t.payload);n&&(n.quantity++,n.total_price=Number((n.price*n.quantity).toFixed(2)),g(e))}},decreaseQuantity(e,t){let n=e.find(e=>e.cart_id===t.payload);if(n){if(1===n.quantity){a.caseReducers.deleteItem(e,t),g(e);return}n.quantity--,n.total_price=Number((n.price*n.quantity).toFixed(2)),g(e)}},enableRenew(e,t){let{id:n,isRenew:r}=t.payload,o=e.find(e=>e.cart_id===n);o&&(o.recurring=r?1:0,g(e))},clearCart(e){e.length=0,g(e)}}}),{addItem:i,deleteItem:u,increaseQuantity:c,decreaseQuantity:s,clearCart:l,enableRenew:d}=a.actions;function f(e){return 5>e.reduce((e,t)=>e+t.quantity,0)}function m(e){return e.reduce((e,t)=>e+t.quantity,0)}function p(e){return Number(e.reduce((e,t)=>e+t.total_price,0).toFixed(2))}function x(e,t){var n;return null===(n=e.find(e=>e.cart_id===t))||void 0===n?void 0:n.quantity}function g(e){localStorage.setItem("cartItems",JSON.stringify(e))}let y=a.reducer},6247:function(e,t){t.Z={src:"/_next/static/media/canada.3f73cf35.svg",height:40,width:40,blurWidth:0,blurHeight:0}}}]);